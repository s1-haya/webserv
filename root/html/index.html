<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Web Server</title>
    <script>
      function updateFormAction(event, basePath, method) {
        event.preventDefault();
        const form = event.target;
        const filename = form.filename.value;
        const url = `${basePath}${filename}`;
        
        fetch(url, {
          method: method,
        })
        .then(response => {
          if (response.ok) {
            alert(`${method} method succeeded for ${filename}`);
          } else {
            alert(`${method} method failed for ${filename}`);
          }
        })
        .catch(error => {
          alert(`${method} method failed due to an error: ${error}`);
        });
      }
    </script>
  </head>
  <body>
    <h1>Hello from webserv!</h1>

    <div class="method">
      <h2>GET</h2>
      <ul>
        <li><a href="sub/">link to sub/</a></li>
        <li>
          <a href="non-existent-path/">link to non-existent-path/ (404)</a>
        </li>
        <li><a href="upload/">link to upload/</a></li>
      </ul>
    </div>

    <div class="method">
      <h2>POST</h2>
      <form onsubmit="updateFormAction(event, 'upload/', 'POST')" method="POST">
        <label for="text-input">Enter text</label>
        <input type="text" name="user_text" />
        <label for="filename">Enter filename</label>
        <input type="text" name="filename" required />
        <button type="submit">Submit</button>
      </form>
    </div>

    <div class="method">
      <h2>DELETE</h2>
      <form onsubmit="updateFormAction(event, 'upload/', 'DELETE')" method="POST">
        <label for="filename">Enter filename to delete</label>
        <input type="text" name="filename" required />
        <button type="submit">Delete</button>
      </form>
    </div>

    <div class="method">
      <h2>GET(CGI)</h2>
      <p><a href="cgi/print_env.pl">link to cgi/print_env.pl</a></p>
    </div>

    <div class="method">
      <h2>POST(CGI)</h2>
      <p>post to cgi/print_stdin.pl?</p>
      <form action="cgi/print_stdin.pl" method="POST">
        <label for="text-input">Enter text</label>
        <input type="text" name="user_text" />
        <button type="submit">Submit</button>
      </form>
    </div>
  </body>
</html>
